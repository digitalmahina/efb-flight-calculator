# üå§Ô∏è –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –ø–æ–≥–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## üìã –û–±–∑–æ—Ä

–ú–æ–¥—É–ª—å CALCULATIONS —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å –ø–æ–≥–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ—á–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤ –ø–æ–ª–µ—Ç–∞ —Å —É—á–µ—Ç–æ–º —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞
```javascript
import { createCalculationsWithWeather } from './calculations-with-weather.js';

// –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ —Å –ø–æ–≥–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
const calculations = createCalculationsWithWeather(weatherMCP);
await calculations.init();
```

### 2. –ë–∞–∑–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç —Å –ø–æ–≥–æ–¥–æ–π
```javascript
const waypoints = [
    { lat: 55.7558, lon: 37.6176, name: '–ú–æ—Å–∫–≤–∞' },
    { lat: 59.9311, lon: 30.3609, name: '–°–ü–±' }
];

const flightParams = {
    cruiseSpeed: 200,  // –∫–º/—á
    fuelFlow: 600      // –∫–≥/—á
};

const results = await calculations.calculateRouteWithWeather(waypoints, flightParams);
```

### 3. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –±–∞–∑–æ–≤—ã–º–∏ —Ä–∞—Å—á–µ—Ç–∞–º–∏
```javascript
const comparison = await calculations.compareCalculations(waypoints, flightParams);

console.log('–†–∞–∑–Ω–∏—Ü–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏:', comparison.comparison.timeDifferencePercent + '%');
console.log('–†–∞–∑–Ω–∏—Ü–∞ –≤ —Ç–æ–ø–ª–∏–≤–µ:', comparison.comparison.fuelDifferencePercent + '%');
```

## üîß API –º–µ—Ç–æ–¥—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:
- `calculateRouteWithWeather()` - –†–∞—Å—á–µ—Ç —Å –ø–æ–≥–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- `calculateRouteWithoutWeather()` - –†–∞—Å—á–µ—Ç –±–µ–∑ –ø–æ–≥–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- `compareCalculations()` - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞—Å—á–µ—Ç–æ–≤
- `getState()` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–æ–¥—É–ª—è

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–ø—Ü–∏–π:
```javascript
const options = {
    includeForecast: false,  // –í–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–≥–Ω–æ–∑
    includeAlerts: true,     // –í–∫–ª—é—á–∏—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
    useCache: true          // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—ç—à
};
```

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:
- `totalDistance` - –û–±—â–µ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ (–∫–º)
- `totalTime` - –û–±—â–µ–µ –≤—Ä–µ–º—è (—á–∞—Å—ã)
- `totalFuel` - –û–±—â–∏–π —Ä–∞—Å—Ö–æ–¥ —Ç–æ–ø–ª–∏–≤–∞ (–∫–≥)
- `formattedTime` - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è ("—á:–º–º")
- `formattedDistance` - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ
- `formattedFuel` - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞—Å—Ö–æ–¥ —Ç–æ–ø–ª–∏–≤–∞

### –ü–æ–≥–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- `weatherImpact` - –í–ª–∏—è–Ω–∏–µ –ø–æ–≥–æ–¥—ã –Ω–∞ —Ä–∞—Å—á–µ—Ç—ã
- `statistics.weatherRating` - –†–µ–π—Ç–∏–Ω–≥ –ø–æ–≥–æ–¥–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π
- `statistics.riskLevel` - –£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞
- `segments[].weather` - –ü–æ–≥–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ —Å–µ–≥–º–µ–Ω—Ç–∞–º

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ:
- `statistics.timeDifference` - –†–∞–∑–Ω–∏—Ü–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏ —Å –±–∞–∑–æ–≤—ã–º–∏ —Ä–∞—Å—á–µ—Ç–∞–º–∏
- `statistics.fuelDifference` - –†–∞–∑–Ω–∏—Ü–∞ –≤ —Ç–æ–ø–ª–∏–≤–µ —Å –±–∞–∑–æ–≤—ã–º–∏ —Ä–∞—Å—á–µ—Ç–∞–º–∏
- `basicResults` - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±–∞–∑–æ–≤—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

## üå§Ô∏è –ü–æ–≥–æ–¥–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã

### –í–ª–∏—è–Ω–∏–µ –≤–µ—Ç—Ä–∞:
- **–í—Å—Ç—Ä–µ—á–Ω—ã–π –≤–µ—Ç–µ—Ä** - —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤—Ä–µ–º—è –ø–æ–ª–µ—Ç–∞
- **–ü–æ–ø—É—Ç–Ω—ã–π –≤–µ—Ç–µ—Ä** - —É–º–µ–Ω—å—à–∞–µ—Ç –≤—Ä–µ–º—è –ø–æ–ª–µ—Ç–∞
- **–ë–æ–∫–æ–≤–æ–π –≤–µ—Ç–µ—Ä** - –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞—Å—Ö–æ–¥ —Ç–æ–ø–ª–∏–≤–∞

### –í–ª–∏—è–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã:
- **–ù–∏–∑–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞** - —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –ø–ª–æ—Ç–Ω–æ—Å—Ç—å –≤–æ–∑–¥—É—Ö–∞
- **–í—ã—Å–æ–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞** - —É–º–µ–Ω—å—à–∞–µ—Ç –ø–ª–æ—Ç–Ω–æ—Å—Ç—å –≤–æ–∑–¥—É—Ö–∞

### –í–ª–∏—è–Ω–∏–µ –¥–∞–≤–ª–µ–Ω–∏—è:
- **–ù–∏–∑–∫–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ** - —É–º–µ–Ω—å—à–∞–µ—Ç –ø–ª–æ—Ç–Ω–æ—Å—Ç—å –≤–æ–∑–¥—É—Ö–∞
- **–í—ã—Å–æ–∫–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ** - —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –ø–ª–æ—Ç–Ω–æ—Å—Ç—å –≤–æ–∑–¥—É—Ö–∞

### –í–ª–∏—è–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏:
- **–ü–ª–æ—Ö–∞—è –≤–∏–¥–∏–º–æ—Å—Ç—å** - —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤—Ä–µ–º—è –ø–æ–ª–µ—Ç–∞
- **–•–æ—Ä–æ—à–∞—è –≤–∏–¥–∏–º–æ—Å—Ç—å** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –≤—Ä–µ–º—è –ø–æ–ª–µ—Ç–∞

## üìà –†–µ–π—Ç–∏–Ω–≥–∏ –∏ –æ—Ü–µ–Ω–∫–∏

### –†–µ–π—Ç–∏–Ω–≥ –ø–æ–≥–æ–¥–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π:
- `excellent` - –û—Ç–ª–∏—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è
- `good` - –•–æ—Ä–æ—à–∏–µ —É—Å–ª–æ–≤–∏—è
- `moderate` - –£–º–µ—Ä–µ–Ω–Ω—ã–µ —É—Å–ª–æ–≤–∏—è
- `poor` - –ü–ª–æ—Ö–∏–µ —É—Å–ª–æ–≤–∏—è

### –£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞:
- `low` - –ù–∏–∑–∫–∏–π —Ä–∏—Å–∫
- `moderate` - –£–º–µ—Ä–µ–Ω–Ω—ã–π —Ä–∏—Å–∫
- `high` - –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫

## üîÑ –°–æ–±—ã—Ç–∏—è

### –í—Ö–æ–¥—è—â–∏–µ —Å–æ–±—ã—Ç–∏—è:
- `route-loaded` - –ó–∞–≥—Ä—É–∑–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∞
- `flight-params-changed` - –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ–ª–µ—Ç–∞
- `recalculate-route` - –ó–∞–ø—Ä–æ—Å –Ω–∞ –ø–µ—Ä–µ—Å—á–µ—Ç

### –ò—Å—Ö–æ–¥—è—â–∏–µ —Å–æ–±—ã—Ç–∏—è:
- `calculations-complete` - –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞—Å—á–µ—Ç–æ–≤
- `calculations-updated` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—á–µ—Ç–æ–≤
- `calculations-recalculated` - –ü–µ—Ä–µ—Å—á–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω
- `calculation-error` - –û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–æ–≤

## üíæ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–æ–≤ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –Ω–∞ 5 –º–∏–Ω—É—Ç
- –ö—ç—à –æ—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –º–∞—Ä—à—Ä—É—Ç–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞:
```javascript
const cacheStats = calculations.getState().weatherCacheStats;
console.log('–†–∞–∑–º–µ—Ä –∫—ç—à–∞:', cacheStats.calculationCache);
```

## ‚ö†Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### Fallback –∫ –±–∞–∑–æ–≤—ã–º —Ä–∞—Å—á–µ—Ç–∞–º:
–ü—Ä–∏ –æ—à–∏–±–∫–µ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–≥–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –º–æ–¥—É–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ –±–∞–∑–æ–≤—ã–µ —Ä–∞—Å—á–µ—Ç—ã –±–µ–∑ –ø–æ–≥–æ–¥—ã.

### –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –æ—à–∏–±–æ–∫:
- `weatherEnabled: false` - –ü–æ–≥–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–∫–ª—é—á–µ–Ω—ã
- `weatherDataAvailable: false` - –î–∞–Ω–Ω—ã–µ –ø–æ–≥–æ–¥—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã
- `weatherError` - –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
- `fallbackUsed: true` - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω fallback

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
```bash
# –ó–∞–ø—É—Å–∫ –ø—Ä–∏–º–µ—Ä–æ–≤
node examples/weather-integration-example.js

# –í–µ–±-–¥–µ–º–æ
open example-usage.html
```

### –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:
1. **–ë–∞–∑–æ–≤—ã–µ —Ä–∞—Å—á–µ—Ç—ã** - –±–µ–∑ –ø–æ–≥–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2. **–†–∞—Å—á–µ—Ç—ã —Å –≤–µ—Ç—Ä–æ–º** - —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–µ—Ç—Ä–æ–≤—ã–µ —É—Å–ª–æ–≤–∏—è
3. **–†–∞—Å—á–µ—Ç—ã —Å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–æ–π** - —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
4. **–†–∞—Å—á–µ—Ç—ã —Å –¥–∞–≤–ª–µ–Ω–∏–µ–º** - –Ω–∏–∑–∫–æ–µ/–≤—ã—Å–æ–∫–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ
5. **–†–∞—Å—á–µ—Ç—ã —Å –≤–∏–¥–∏–º–æ—Å—Ç—å—é** - –ø–ª–æ—Ö–∞—è –≤–∏–¥–∏–º–æ—Å—Ç—å
6. **–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è** - –≤—Å–µ —Ñ–∞–∫—Ç–æ—Ä—ã –≤–º–µ—Å—Ç–µ
7. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –∫—ç—à–∞
8. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–≥–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å EFB

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:
```javascript
EventBus.on('calculations-complete', (data) => {
    if (data.weatherEnabled) {
        updateWeatherPanel(data.results.weatherImpact);
        updateRiskIndicator(data.results.statistics.riskLevel);
    }
    updateFlightDataDisplay(data.results);
});
```

### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –∫–∞—Ä—Ç–µ:
```javascript
EventBus.on('calculations-complete', (data) => {
    displayWeatherOnMap(data.results.segments);
    showWeatherAlerts(data.results.statistics.riskLevel);
});
```

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:
1. **–í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ** `weatherEnabled` –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–æ–≥–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2. **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ—à–∏–±–∫–∏** –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ fallback –∫ –±–∞–∑–æ–≤—ã–º —Ä–∞—Å—á–µ—Ç–∞–º
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
4. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ —Å–æ–±—ã—Ç–∏—è** –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
1. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ä–µ–π—Ç–∏–Ω–≥ –ø–æ–≥–æ–¥—ã** –ø–µ—Ä–µ–¥ –ø–æ–ª–µ—Ç–æ–º
2. **–û–±—Ä–∞—â–∞–π—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞**
3. **–£—á–∏—Ç—ã–≤–∞–π—Ç–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏** —Å–∏—Å—Ç–µ–º—ã
4. **–°—Ä–∞–≤–Ω–∏–≤–∞–π—Ç–µ —Ä–∞—Å—á–µ—Ç—ã** —Å –ø–æ–≥–æ–¥–æ–π –∏ –±–µ–∑

---

**–ú–æ–¥—É–ª—å –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–π —Å—Ä–µ–¥–µ! üöÄ**
