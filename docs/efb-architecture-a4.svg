<?xml version="1.0" encoding="UTF-8"?>
<!-- EFB Flight Calculator - Architecture Diagram (A4 Landscape, print-ready SVG) -->
<svg xmlns="http://www.w3.org/2000/svg" width="297mm" height="210mm" viewBox="0 0 297 210">
  <!-- Styles -->
  <defs>
    <style><![CDATA[
      .title { font: 12px Inter, Arial, sans-serif; font-weight: 700; fill: #0f172a; }
      .subtitle { font: 6px Inter, Arial, sans-serif; fill: #334155; }
      .label { font: 6px Inter, Arial, sans-serif; fill: #0f172a; font-weight: 600; }
      .small { font: 5px Inter, Arial, sans-serif; fill: #334155; }
      .box { fill: #ffffff; stroke: #0ea5e9; stroke-width: 0.5; rx: 2; ry: 2; }
      .layer { fill: #f1f5f9; stroke: #94a3b8; stroke-width: 0.4; rx: 2.5; ry: 2.5; }
      .arrow { stroke: #0f172a; stroke-width: 0.5; marker-end: url(#arrowHead); fill: none; }
      .pill { fill: #ecfeff; stroke: #0891b2; stroke-width: 0.4; rx: 1.5; ry: 1.5; }
      .note { fill: #eef2ff; stroke: #6366f1; stroke-width: 0.35; rx: 1.2; ry: 1.2; }
    ]]></style>
    <marker id="arrowHead" markerWidth="6" markerHeight="6" refX="4" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L6,3 L0,6 z" fill="#0f172a" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="148.5" y="14" text-anchor="middle" class="title">EFB Flight Calculator</text>
  <text x="148.5" y="24" text-anchor="middle" class="subtitle">Схема связей модулей (A4 Landscape)</text>

  <!-- Column headers -->
  <text x="57.5" y="38" text-anchor="middle" class="small">Presentation Layer</text>
  <text x="148.5" y="38" text-anchor="middle" class="small">Business Logic Layer</text>
  <text x="239.5" y="38" text-anchor="middle" class="small">Data Access Layer</text>

  <!-- Column layers -->
  <rect x="15" y="42" width="85" height="80" class="layer" />
  <rect x="106" y="42" width="85" height="80" class="layer" />
  <rect x="197" y="42" width="85" height="80" class="layer" />

  <!-- Presentation: core-ui -->
  <rect x="22" y="50" width="71" height="66" class="box" />
  <text x="57.5" y="58" text-anchor="middle" class="label">core-ui/</text>
  <rect x="27" y="64" width="61" height="12" class="pill" />
  <text x="57.5" y="72" text-anchor="middle" class="small">efb-layout.html</text>
  <rect x="27" y="78" width="61" height="12" class="pill" />
  <text x="57.5" y="86" text-anchor="middle" class="small">efb-styles.css</text>
  <rect x="27" y="92" width="61" height="12" class="pill" />
  <text x="57.5" y="100" text-anchor="middle" class="small">route/map panels</text>

  <!-- Business: calculations + weather-module -->
  <rect x="113" y="50" width="71" height="66" class="box" />
  <text x="148.5" y="58" text-anchor="middle" class="label">calculations/</text>
  <rect x="118" y="64" width="61" height="12" class="pill" />
  <text x="148.5" y="72" text-anchor="middle" class="small">distance, time, fuel</text>
  <rect x="118" y="78" width="61" height="12" class="pill" />
  <text x="148.5" y="86" text-anchor="middle" class="small">route optimizer</text>

  <!-- Consolidated weather-module -->
  <rect x="113" y="100" width="71" height="14" class="note" />
  <text x="148.5" y="110" text-anchor="middle" class="small">weather-module (consolidated)</text>

  <!-- Data: mcp-integration -->
  <rect x="204" y="50" width="71" height="66" class="box" />
  <text x="239.5" y="58" text-anchor="middle" class="label">mcp-integration/</text>
  <rect x="209" y="64" width="61" height="12" class="pill" />
  <text x="239.5" y="72" text-anchor="middle" class="small">mcp-client</text>
  <rect x="209" y="78" width="61" height="12" class="pill" />
  <text x="239.5" y="86" text-anchor="middle" class="small">mcp-tools</text>

  <!-- Shared row -->
  <rect x="15" y="128" width="267" height="28" class="layer" />
  <text x="22" y="136" class="small">shared/</text>
  <rect x="22" y="140" width="60" height="14" class="box" />
  <text x="52" y="149" text-anchor="middle" class="small">event-bus.js</text>
  <rect x="86" y="140" width="60" height="14" class="box" />
  <text x="116" y="149" text-anchor="middle" class="small">utils.js</text>
  <rect x="150" y="140" width="60" height="14" class="box" />
  <text x="180" y="149" text-anchor="middle" class="small">constants.js</text>
  <rect x="214" y="140" width="60" height="14" class="box" />
  <text x="244" y="149" text-anchor="middle" class="small">index.html / main.js</text>

  <!-- Integration row -->
  <rect x="15" y="160" width="267" height="28" class="layer" />
  <text x="22" y="168" class="small">integration/</text>
  <rect x="22" y="172" width="70" height="12" class="box" />
  <text x="57" y="180" text-anchor="middle" class="small">module-loader.js</text>
  <rect x="96" y="172" width="70" height="12" class="box" />
  <text x="131" y="180" text-anchor="middle" class="small">smart-cache.js</text>
  <rect x="170" y="172" width="45" height="12" class="box" />
  <text x="192.5" y="180" text-anchor="middle" class="small">efb-cache.js</text>
  <rect x="219" y="172" width="60" height="12" class="box" />
  <text x="249" y="180" text-anchor="middle" class="small">predictive-cache.js</text>

  <!-- External APIs -->
  <rect x="15" y="190" width="267" height="14" class="layer" />
  <text x="22" y="198" class="small">External APIs</text>
  <rect x="55" y="192" width="70" height="10" class="box" />
  <text x="90" y="199" text-anchor="middle" class="small">Weather API</text>
  <rect x="121" y="192" width="70" height="10" class="box" />
  <text x="156" y="199" text-anchor="middle" class="small">MCP Servers</text>
  <rect x="187" y="192" width="70" height="10" class="box" />
  <text x="222" y="199" text-anchor="middle" class="small">GPX Parser</text>

  <!-- Arrows: core-ui -> calculations -->
  <path class="arrow" d="M100,83 C106,83 106,83 113,83" />
  <!-- Arrows: calculations -> mcp-integration -->
  <path class="arrow" d="M184,83 C190,83 190,83 204,83" />
  <!-- Arrows: weather-module depends on shared -->
  <path class="arrow" d="M148.5,114 C148.5,122 148.5,128 148.5,140" />
  <!-- Arrows: core-ui uses shared -->
  <path class="arrow" d="M57.5,116 C57.5,124 57.5,128 57.5,140" />
  <!-- Arrows: mcp-integration uses shared -->
  <path class="arrow" d="M239.5,116 C239.5,124 239.5,128 239.5,140" />
  <!-- Arrows: integration ties layers -->
  <path class="arrow" d="M148.5,156 C148.5,160 148.5,160 148.5,172" />

  <!-- Footer note -->
  <rect x="15" y="12" width="0.1" height="0.1" fill="none" />
</svg>
